# 第七章 文件系统

## 第一节 文件系统的基本概念

### 一、文件系统的任务

#### 1、文件的定义

- 研究文件系统的两种观点：

  用户观点：关心文件有什么组成，如何命名，如何保护文件，可以进行何种操作。

  系统观点：文件目录是怎样实现的，怎样管理存储空间，文件存储位置，磁盘实际运作方式，存取速度，磁盘利用率等等。

- 文件的定义：一组带标识的、在逻辑上有完整意义的信息项的序列
- 读写指针：读指针用来记录文件当前的读取位置，写指针用来记录文件当前的写入位置
- 特点：存储在磁盘，可长期保存。

#### 2、文件系统的定义

文件系统是操作系统中统一管理信息资源的一种软件。它管理文件的存储、检索、更新，提供更安全的共享和保护手段，并且方便用户使用。

功能： 

- 统一管理文件的存储空间，实施存储空间的分配与回收
- 实现文件按名存取，以对用户透明的方式管理命名空间
- 实现文件信息的共享，并提供文件的共享和保密措施
- 向用户提供一个方便使用的接口
- 系统维护及向用户提供有关信息
- 保持文件系统的执行效率
- 提供与I/O的统一接口

### 二、文件的存储介质及存取方式

#### 1、外存储设备的特点

特点：容量大、断点后仍可保存信息

组成：驱动部分和存储介质部分

种类：磁盘、磁带、磁鼓、纸带、光盘、闪存

#### 2、外存储设备的介质

##### (1) 磁带

![](F:\自考\操作系统\img\2020-05-21_154836.jpg)

特点：容量大，存取速度慢，适合顺序存储。

##### (2) 磁盘

分类：软盘和硬盘

特点：容量大，成本低，适合随机存储

![](F:\自考\操作系统\img\2020-05-21_155355.jpg)

##### (3) 光盘

是利用在激光的作用下特性发生变化的一些材料制成的非磁性记录介质

特点：容量大、速度快、价格便宜

##### (4) 闪存

特点：电擦除，随机存取、可靠性高、寿命长

#### 3、文件在存储设备中的存取方式

顺序存取：按从前到后的次序依次访问文件的各个信息项

随机存取：又称直接存取，允许用户按任意的次序、直接存取文件中的任意一个记录，或者根据存取命令把读写指针移到文件中的指定记录读取。

### 三、文件的分类

#### 1、按文件的用途分类

- 系统文件
- 库函数文件
- 用户文件

#### 2、按文件的组织方式分类

- 普通文件
- 目标文件
- 特殊文件

#### 3、一些常见的文件分类方式

- 按文件的保护方式：只读文件、读写文件、可执行文件、无保护文件
- 按信息的流向分：输入文件、输出文件、输入输出文件
- 按存放时限分：临时文件、永久文件、档案文件
- 按存储介质分：磁盘文件、磁带文件、卡片文件按等
- 按文件的组织结构分类：逻辑文件、物理文件

#### 4、UNIX类操作系统中文件的分类

- 普通文件
- 目录文件
- 特殊文件

## 第二节 文件的逻辑结构和物理结构

文件的逻辑结构：

从用户观点出发所观察到的文件组织形式

文件的物理结构：

又称为文件的存储结构。是指系统文件存储在外存上所形成的一种存储组织形式，是用户不能看见的。

### 一、文件的逻辑结构

#### 1、设计文件逻辑结构的原则

- 易于操作
- 查找快捷
- 修改方便
- 空间紧凑

#### 2、文件的逻辑结构

文件的逻辑结构所描述的信息是文件中信息的组织形式，可分为三/两类：

- 流式文件：有序字符的集合，基本单位是字符。源程序、目标代码等属于流式文件
- 记录式文件：是一组有序记录的集合，基本单位是记录。又可分为定长记录文件和变长记录文件

![](F:\自考\操作系统\img\2020-05-21_162635.jpg)

### 二、文件的物理结构

#### 1、顺序结构

- 顺序结构原理

  又称连续结构，他把逻辑上的连续文件信息依次存放在连续编号的物理块中。

![](F:\自考\操作系统\img\2020-05-21_163019.jpg)

- 顺序结构的优缺点

  - 优点

    存取速度快，一旦知道了问价在存储设备上的起始位置和文件长度，便能快速进行存取

    支持顺序存放和随机存放。

  - 缺点

    文件不能动态增长

    要求为一个文件分配连续的存储空间

    不能灵活的删除和插入记录

    出现碎片

#### 2、链接结构

- 链接结构原理

  将逻辑上连续的文件分散存储在若干个不连续的物理块中。每个物理块中都设有一个指针，指向其他后续的物理块。

  ![](F:\自考\操作系统\img\2020-05-21_170655.jpg)

- 优点

  解决了碎片问题，提高了磁盘空间利用率

  文件可以动态扩充

- 缺点

  存取速度慢，不适于随机存取

  可靠性差

#### 3、索引结构

- 索引结构原理

  为每个文件分配一个索引块(表)，把分配给该文件的所有盘块号，都记录在该索引块中

  ![](F:\自考\操作系统\img\2020-05-21_171155.jpg)

- 优点

  文件动态增长

  不要求为一个文件分配连续的存储空间

  能灵活删除和插入记录

  能顺序存取和随机存取

- 缺点

  引起较多的寻道次数和寻道时间

  索引表本身增加了存储空间的开销

- 多级索引

  当文件太大，其索引块太多，单级索引方式过于低效。此时，应为这些索引块在建立一级索引，称为第一季索引，及系统再分配一个索引块，作为一级索引的索引块，将第一块、第二块、...等索引块的盘块号，填入到此 索引表中，这样便形成了两级所用分配方式。如果文件非常大时，还可用三级、四级索引分配方式。

### 三、UNIX的三级索引结构

![](F:\自考\操作系统\img\2020-05-21_172651.jpg)