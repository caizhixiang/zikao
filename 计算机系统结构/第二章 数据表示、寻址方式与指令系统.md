# 第二章 数据表示、寻址方式与指令系统

## 一、数据表示

### (一) 基本概念

#### 1、数据表示与数据结构

- 数据表示：计算机硬件能够直接识别、指令集可以直接调用的数据类型

 		所有数据类型中最常用、相对比较简单、用硬件实现比较容易的几种。

- 数据结构：由软件进行处理和实现的各种数据类型

   	研究:这些数据类型的逻辑结构与物理结构之间的关系，并给出相应的算法。

- 系统结构设计者要解决的问题：如何确定数据表示？

  ​	 (软硬件取舍折中的问题)

#### 2、 数据表示类型

- 当机器设置有定点加、减、乘、除、移位、比较等一系列定点运算指令和相应的运算硬件,可以直接对定点数进行理时,机器就有了定点数据表示。

- 当机器设置有逻辑加、逻辑乘、按位相加、逻辑等一系列逻辑运算指令和相应的逻辑运算硬件,可以直接对逻辑数进行各种处理,机器就有了逻辑数据表示。

-  类似的,若机器设置有浮点运算指令(如浮点加、减、乘、除、比较、存、取等)和相应的运算硬件,可以直接使用浮点数进行各种处理,机器就有了浮点数据表示。

#### 3、 变址操作对向量、阵列数据结构的支持

 	机器的运算类指令和运算器结构主要是按机器有什么样的数据表示来确定的

![](F:\自考\计算机系统结构\img\2020-05-26_112356.jpg)

#### 4、 引入数据表示的原则

1. 一方面是看系统的效率有否提高，即是否减少了实现时间和所需的存贮空间。

   衡量实现时间是否减少，主要是看在主存和处理机之间传递 的信息量有否减少传送的信息量越少,其实时间就会越少。

2. 引入这种数据表示后,其通用性和利用率是否高。

   如果只对某种数据结构的实现效率很高,而对其他数据结构的实现效率很低，或者引入这种数据表示在应用中很少用到，那么为此所花的硬件过多却并未在性能上得到好处，必然导致性能价格比的下降，特别是对一些复杂的数据表示。

#### 5、操作数的大小：操作数的位数或字节数

字节Byte：（8位）、半字half：（16位）、字word：（32位）、双字double：（64位）

![](F:\自考\计算机系统结构\img\2020-05-26_114100.jpg)

 基准程序对单字定点和双字浮点数据访问具有较高的频度

```
位：bit
字符:用ASCLL码表示,为一个字节大小
整数:用二进制补码表示,其大小可以是字节、半字或单字。
浮点操作数:单精度浮点数(1个字)、双精度浮点数(双字)。
	一般都采用IEEE 754浮点标准
十进制数据
```

### (二) 高级数据概念

#### 1、高级数据表示

- 自定义数据表示

  标识符数据表示 --------- 一对一

  数据描述符        --------- 一对多

- 向量、数组数据表示
- 堆栈数据表示

##### 1）自定义数据表示 - 标识符数据表示

###### （1）表示操作数类类型的方法有两种

1. 有指令中的操作码指定操作数的类型

   |      |      |      |
   | :--: | :--: | :--: |
   | 浮点 |  I   |  J   |

   

2. 带标识符的数据表示。给数据加上标识，由数据本身给出操作数类型。

   ![](F:\自考\计算机系统结构\img\2020-05-26_123226.jpg)

###### （2）标志符数据表示的主要优点

 (1) 简化了指令系统和程序设计。

 (2) 简化了编译程序。

 (3) 便于实现一致性校验。

 (4) 能由硬件自动完成数据类型的变换。

 (5) 支持了数据库系统的实现与数据类型无关的要求

 (6) 为软件调试和应用软件开发提供了支持。

###### （3）标识符数据表示的主要问题

 (1) 每个数据字因增设标志符,会使程序所占用的主存空间增加。 但指令种类变少,操作码位数缩短

![](F:\自考\计算机系统结构\img\2020-05-26_132718.jpg)

 (2) 采用标志符会降低指令的执行速度。

 需要增加按标志符确定数据属性,判断操作数之间是否相容,单条指令执行速度下降

 总体上看,由于程序的编制和调试时间缩短,总开销时间变低。

 微观性能下降,宏观性能提升

##### 2）自定义数据表示 - 数据描述符

​		为进一步减少标志符所占的存贮空间,对于向量、数组、记录等数据,由于每个元素具有相同的属性,为此，发展出数据描述符。

 		据描述符和标志符的差别在于标志符是和每个数据相连的,合存在一个存贮单元中,描述单个数据的类型特征

 		述符是和数据分开存放的,专门用来描述所要访问的数据是整块数据还是单个数据,访问该数据块或数据元素所需要的地址以及其他特征信息等。

数据描述符举例：

以`B6700`是描述符为例，其数据描述和数据的形式分别如下所示：

描述符：

|      |            |      |      |
| :--: | :--------: | :--: | :--: |
| 101  | 各种标识符 | 长度 | 数据 |

数据：

|      |      |
| :--: | :--: |
| 000  | 数据 |

1. `B6700`访问过程

![](F:\自考\计算机系统结构\img\1.jpg)

2. `B6700`访存多维过程

   3 * 4 的二维阵列

   陈列描述符连接到二级描述符向量

   ![](F:\自考\计算机系统结构\img\2020-05-26_135201.jpg)

#### 2、向量处理

 增设向量、数组数据表示,硬件支持,做成向

 例如,要计算![](F:\自考\计算机系统结构\img\2020-05-26_143628.jpg)      i=10.11,…,1000

 用C语言写成的有关循环部分为

```
 for(i=10 ; i<1000; i++)

 C(i) = a(i+5) + B(i)
```

改进：

 		在具有向量、数组数据表示的向量处理机上,表现除在硬件上设置有丰富的向量或阵列运算指令,配置有以流水或阵列方式处理的高速运算器,只需用一条如下的向量加法指令：

|        |           |           |           |
| :----: | :-------: | :-------: | :-------: |
| 向量加 | A向量参数 | B向量参数 | C向量参数 |

​		引入向量、数组数据表示不只是能加快形成元素地址，更主要的是便于实现把向量各元素成块预取到中央处理机，用一条向量、数组指令流水或同时对整个向量、数组高速处理硬件判断下标是否越界,并让越界判断和元素运算并行。

#### 3、堆栈

1. 堆栈的表示

    堆栈数据表示在编译和子程序调用中很有用。

    有堆栈数据表示的计算机称为堆栈计算机。

    (1) 有若干高速寄存器组成的硬件堆栈,并附加控制电路让它与主存中的堆栈区在逻辑上组      		成一个整体,使堆栈的访问速度是寄存器的,堆栈的容量是主存的。

    (2) 有很丰富的堆栈操作类指令且功能很强,直接可对堆栈中的数据进行各种运算和处理。

    (3) 有力地支持高级语言程序的编译。

    (4) 有力地支持子程序的嵌套和递归调用

   ![](F:\自考\计算机系统结构\img\2020-05-26_145303.jpg)![](F:\自考\计算机系统结构\img\2020-05-26_145334.jpg)

### (三) 浮点数尾数基值大小和下溢处理

#### 1、浮点数的一般格式    

```
如果是二进制，rm就是2
```

![](F:\自考\计算机系统结构\img\2020-05-26_151118.jpg)

#### 2、浮点数克表示实数域中的值

![](F:\自考\计算机系统结构\img\2020-05-26_152015.jpg)

#### 3、浮点数尾数基值的选择

（1）可表示数的范围

​		随进制的增大,可表示数的范围增大。换句话说，对于大的进制值,为表示相同范围的数,其阶码的位数P，可以减少。

 （2）可表示数的个数。

 		进制的增大可表示数的个数增大。很容易得出,进制用16与用2的可表示数的个数之比为![](F:\自考\计算机系统结构\img\2020-05-26_152542.jpg)

 （3） 数在实数轴上的分布。

 		看出进制用16的比用2的可表示在数实数轴上的分布要稀疏。

 （4）可表示数的精度。

​		由于进制愈大,数在数轴上的分布变稀,已可得出数的表示精度下降的结论。

 （5）运算中的精度损失。

​		运算中的精度损失是指由于运算过程中尾数右移出机器字长使得有效数字丢失后所造成的精度损失,因此它与可表示数的精度是两个不同的概念。

 		因此进制愈大,尾数右移的可能性愈小,精度的损失就越小。

 （6）运算速度。

​		由于进制大时发生因对阶或尾数溢出需右移及规格化需要左移的次数显著减少,因此运算速度可以提高。

#### 4、浮点数尾数的下溢处理方法

1. 截断法

2. 舍入法

3. 恒置“1”法

4. 查表舍入法

##### (1) 截断法

--- 总比实际值少一点

![](F:\自考\计算机系统结构\img\2020-05-26_153805.jpg)

##### (2) 舍入法

---- 有时少有时多，硬件有所损耗，多做一步。

![](F:\自考\计算机系统结构\img\2020-05-26_153939.jpg)

##### (3) 恒置“1”法

---- 误差大

![](F:\自考\计算机系统结构\img\2020-05-26_154145.jpg)

##### (4) 查表舍入法

![](F:\自考\计算机系统结构\img\2020-05-26_154217.jpg)

K位ROM查表舍入

![](F:\自考\计算机系统结构\img\2020-05-26_154742.jpg)

##### 总结

 		计算机组成设计必须注意解决好数的下溢处理。

 		因为这种精度损失对系统程序和应用程序设计者都是透明的,设计得不好,同样的题目在不同下溢处理方法的机器会得到不同的运算结果。

因此,下溢处理方法的选择在速度、误差、造价、实现方法等多方面的综合权衡

通过对浮点数尾数基数大小和下溢处理方法选择的讲述,以看出:

 1) 系统结构的研究方法往往是设法找出影响问题的各个因素

 2) 建立起相关的数学模型(可以是数学公式,也可以是图形曲线)

 3) 为了简化模型,去除一些不影响结论的枝节因素,尽可能推导出一些定量公式

 4) 以使得到必要的结论来指导设计。

## 二、寻址方式

## 三、指令系统的设计和优化

## 四、指令系统的发展和改进

